{% extends 'base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="min-h-screen" style="background-color: #181d37;">
    <div class="max-w-7xl mx-auto px-6 py-8">
        
        <!-- Hero / Header Section -->
        <div class="mb-12 pb-8 border-b" style="border-color: rgba(99, 102, 241, 0.3);">
            <div class="flex flex-col md:flex-row md:items-start md:justify-between md:gap-6">
                <div class="flex-1">
                    <div class="text-xs font-semibold text-cyan-400 uppercase tracking-wider mb-3">DASHBOARD</div>
                    <h1 class="text-5xl font-bold text-white tracking-tight mb-3">Platform Overview</h1>
                    <p class="text-base text-slate-300 leading-relaxed max-w-2xl">Monitor platform activity, manage courses, and track student engagement across all programs.</p>
                </div>
                <div class="flex items-center gap-4 mt-6 md:mt-0">
                    <select class="border px-4 py-2.5 text-sm font-medium text-white rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-all" style="background-color: rgba(24, 29, 55, 0.6); border-color: rgba(99, 102, 241, 0.4);">
                        <option>All Programs</option>
                        <option>Active Only</option>
                        <option>Archived</option>
                    </select>
                    <div class="relative">
                        <input type="search" placeholder="Search courses..." class="border pl-10 pr-4 py-2.5 text-sm text-white rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-all w-56 placeholder:text-slate-400" style="background-color: rgba(24, 29, 55, 0.6); border-color: rgba(99, 102, 241, 0.4);">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 text-sm"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Grid (Compact) -->
        <div class="grid md:grid-cols-4 gap-5 mb-10">
            <div class="border rounded-xl p-5 transition-all backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                <div class="text-xs font-semibold text-cyan-400 uppercase tracking-wide mb-2">Total Students</div>
                <div class="text-3xl font-bold text-white mb-1">{{ total_students }}</div>
                <div class="text-xs text-slate-400">
                    <i class="fas fa-user-check mr-1 text-emerald-500"></i>{{ active_students }} active (30d)
                </div>
            </div>
            
            <div class="border rounded-xl p-5 transition-all backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                <div class="text-xs font-semibold text-cyan-400 uppercase tracking-wide mb-2">New Students</div>
                <div class="text-3xl font-bold text-white mb-1">{{ new_students }}</div>
                <div class="text-xs text-slate-400">Last 7 days</div>
            </div>
            
            <div class="border rounded-xl p-5 transition-all backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                <div class="text-xs font-semibold text-cyan-400 uppercase tracking-wide mb-2">Enrollments</div>
                <div class="text-3xl font-bold text-white mb-1">{{ total_enrollments }}</div>
                <div class="text-xs text-slate-400">All time</div>
            </div>
            
            <div class="border rounded-xl p-5 transition-all backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                <div class="text-xs font-semibold text-cyan-400 uppercase tracking-wide mb-2">Certifications</div>
                <div class="text-3xl font-bold text-white mb-1">{{ total_certifications }}</div>
                <div class="text-xs text-slate-400">Issued</div>
            </div>
        </div>

        <!-- Primary Focus Section: Featured Course -->
        {% if featured_course %}
        <div class="mb-12">
            <div class="border rounded-2xl p-8 transition-all relative backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                <span class="absolute top-4 right-4 px-3 py-1 bg-emerald-500/20 text-emerald-400 text-xs font-semibold rounded-full border border-emerald-500/30">Active</span>
                <div class="flex flex-col lg:flex-row gap-8">
                    <!-- Left: Course Thumbnail and Info -->
                    <div class="flex-shrink-0">
                        {% if featured_course.thumbnail %}
                        <img src="{{ featured_course.thumbnail.url }}" alt="{{ featured_course.name }}" class="w-full lg:w-64 h-48 lg:h-40 object-cover rounded-xl">
                        {% else %}
                        <div class="w-full lg:w-64 h-48 lg:h-40 bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 rounded-xl flex items-center justify-center relative">
                            <span class="absolute top-3 left-3 px-2 py-1 text-cyan-400 text-xs font-semibold rounded" style="background-color: rgba(24, 29, 55, 0.7);">VIDEO PROGRAM</span>
                            <i class="fas fa-video text-4xl text-cyan-400/60"></i>
                        </div>
                        {% endif %}
                        <div class="mt-3 flex items-center gap-2 text-xs text-slate-400">
                            <i class="fas fa-video text-cyan-400"></i>
                            <span>{{ featured_course.lesson_set.count }} lessons</span>
                        </div>
                    </div>
                    
                    <!-- Center: Course Details -->
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="text-xs font-semibold text-cyan-400 uppercase tracking-wider">{{ featured_course.course_type|upper }} Program</div>
                            <button class="text-slate-400 hover:text-red-500 transition-colors">
                                <i class="fas fa-heart"></i>
                            </button>
                        </div>
                        <h2 class="text-2xl font-bold text-white mb-3">{{ featured_course.name }}</h2>
                        <p class="text-sm text-slate-300 leading-relaxed mb-4 line-clamp-2">{{ featured_course.short_description|default:featured_course.description|truncatewords:30 }}</p>
                        
                        <!-- Metadata Row -->
                        <div class="flex flex-wrap items-center gap-3 text-xs mb-6">
                            <span class="px-3 py-1.5 rounded-lg text-cyan-400 flex items-center gap-1.5" style="background-color: rgba(24, 29, 55, 0.6); border: 1px solid rgba(6, 182, 212, 0.3);">
                                <i class="fas fa-brain"></i>
                                AI Lesson Coach
                            </span>
                            {% if featured_course.is_accredible_certified %}
                            <span class="px-3 py-1.5 rounded-lg text-cyan-400 flex items-center gap-1.5" style="background-color: rgba(24, 29, 55, 0.6); border: 1px solid rgba(6, 182, 212, 0.3);">
                                <i class="fas fa-check-circle"></i>
                                Accredible Certified
                            </span>
                            {% endif %}
                            {% if featured_course.has_asset_templates %}
                            <span class="px-3 py-1.5 rounded-lg text-cyan-400 flex items-center gap-1.5" style="background-color: rgba(24, 29, 55, 0.6); border: 1px solid rgba(6, 182, 212, 0.3);">
                                <i class="fas fa-box-arrow-up-right"></i>
                                Asset Templates Included
                            </span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Right: Actions -->
                    <div class="flex flex-col justify-center gap-3 lg:w-48">
                        <a href="{% url 'dashboard_course_detail' featured_course.slug %}" 
                           class="w-full px-5 py-3 bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-xl font-semibold text-sm text-center hover:shadow-lg hover:shadow-cyan-500/20 transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[#181d37] focus:ring-cyan-500">
                            <i class="fas fa-cog mr-2"></i>Manage Course
                        </a>
                        <a href="{% url 'dashboard_course_detail' featured_course.slug %}" 
                           class="w-full px-5 py-2.5 bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-xl font-semibold text-sm text-center hover:shadow-lg hover:shadow-cyan-500/20 transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[#181d37] focus:ring-cyan-500">
                            View Details
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Secondary Programs Section -->
        <div class="mb-12">
            <div class="flex items-center justify-center gap-3 mb-6">
                <div class="w-10 h-10 rounded-lg bg-purple-500/20 border border-purple-500/30 flex items-center justify-center">
                    <i class="fas fa-book text-purple-400"></i>
                </div>
                <h2 class="text-xl font-bold text-white">Learn More</h2>
                <div class="flex-1 h-px ml-4" style="background: linear-gradient(to right, rgba(168, 85, 247, 0.5), transparent);"></div>
            </div>
            
            {% if secondary_courses %}
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for course in secondary_courses %}
                <div class="rounded-xl p-6 transition-all relative backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                    <span class="absolute top-4 right-4 px-3 py-1 bg-emerald-500/20 text-emerald-400 text-xs font-semibold rounded-full border border-emerald-500/30">Active</span>
                    {% if course.thumbnail %}
                    <img src="{{ course.thumbnail.url }}" alt="{{ course.name }}" class="w-full h-40 object-cover rounded-lg mb-4">
                    {% else %}
                    <div class="w-full h-40 bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 rounded-lg flex items-center justify-center mb-4 relative">
                        <span class="absolute top-2 left-2 px-2 py-1 text-cyan-400 text-xs font-semibold rounded" style="background-color: rgba(24, 29, 55, 0.7);">VIDEO PROGRAM</span>
                        <i class="fas fa-video text-3xl text-cyan-400/60"></i>
                    </div>
                    {% endif %}
                    <div class="flex items-center gap-2 mb-2">
                        <div class="text-xs font-semibold text-cyan-400 uppercase tracking-wide">{{ course.course_type|upper }}</div>
                        <button class="text-slate-400 hover:text-red-500 transition-colors ml-auto">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                    <h3 class="text-lg font-bold text-white mb-2">{{ course.name }}</h3>
                    <p class="text-sm text-slate-300 leading-relaxed mb-4 line-clamp-2">{{ course.short_description|default:course.description|truncatewords:15 }}</p>
                    <a href="{% url 'dashboard_course_detail' course.slug %}" 
                       class="inline-flex items-center justify-center w-full px-4 py-2.5 bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-lg font-semibold text-sm hover:shadow-lg hover:shadow-cyan-500/20 transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[#181d37] focus:ring-cyan-500">
                        <i class="fas fa-arrow-right mr-2"></i>Start Course
                    </a>
                </div>
                {% endfor %}
            </div>
            {% else %}
                <div class="border rounded-xl p-12 text-center backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-xl mb-4" style="background-color: rgba(99, 102, 241, 0.2);">
                    <i class="fas fa-inbox text-2xl text-slate-400"></i>
                </div>
                <p class="text-sm font-medium text-slate-300">No additional courses available</p>
            </div>
            {% endif %}
        </div>

        <!-- Quick Actions Grid -->
        <div class="mb-12">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 rounded-lg bg-cyan-500/20 border border-cyan-500/30 flex items-center justify-center">
                    <i class="fas fa-bolt text-cyan-400"></i>
                </div>
                <h2 class="text-xl font-bold text-white">Quick Actions</h2>
            </div>
            <div class="grid md:grid-cols-4 gap-5">
                <a href="{% url 'dashboard_courses' %}" class="border rounded-xl p-6 transition-all group backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                    <div class="w-12 h-12 bg-violet-500/20 border border-violet-500/30 rounded-lg flex items-center justify-center mb-4 group-hover:bg-violet-500/30 transition-colors">
                        <i class="fas fa-book text-violet-400 text-xl"></i>
                    </div>
                    <div class="font-semibold text-white text-sm">Manage Courses</div>
                </a>
                <a href="{% url 'dashboard_students' %}" class="border rounded-xl p-6 transition-all group backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                    <div class="w-12 h-12 bg-cyan-500/20 border border-cyan-500/30 rounded-lg flex items-center justify-center mb-4 group-hover:bg-cyan-500/30 transition-colors">
                        <i class="fas fa-users text-cyan-400 text-xl"></i>
                    </div>
                    <div class="font-semibold text-white text-sm">Manage Students</div>
                </a>
                <a href="{% url 'dashboard_analytics' %}" class="border rounded-xl p-6 transition-all group backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                    <div class="w-12 h-12 bg-emerald-500/20 border border-emerald-500/30 rounded-lg flex items-center justify-center mb-4 group-hover:bg-emerald-500/30 transition-colors">
                        <i class="fas fa-chart-bar text-emerald-400 text-xl"></i>
                    </div>
                    <div class="font-semibold text-white text-sm">Analytics</div>
                </a>
                <a href="{% url 'dashboard_lessons' %}" class="border rounded-xl p-6 transition-all group backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                    <div class="w-12 h-12 bg-amber-500/20 border border-amber-500/30 rounded-lg flex items-center justify-center mb-4 group-hover:bg-amber-500/30 transition-colors">
                        <i class="fas fa-video text-amber-400 text-xl"></i>
                    </div>
                    <div class="font-semibold text-white text-sm">Manage Lessons</div>
                </a>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="border rounded-2xl p-8 backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.5); border-color: rgba(99, 102, 241, 0.3);">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 rounded-lg bg-emerald-500/20 border border-emerald-500/30 flex items-center justify-center">
                    <i class="fas fa-clock text-emerald-400"></i>
                </div>
                <h2 class="text-xl font-bold text-white">Recent Activity</h2>
            </div>
            {% if recent_activities %}
            <div class="space-y-3">
                {% for activity in recent_activities %}
                <div class="border flex items-center gap-4 p-4 rounded-xl transition-all backdrop-blur-sm" style="background-color: rgba(24, 29, 55, 0.7); border-color: rgba(99, 102, 241, 0.3);" onmouseover="this.style.borderColor='rgba(99, 102, 241, 0.6)'" onmouseout="this.style.borderColor='rgba(99, 102, 241, 0.3)'">
                    <div class="w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0
                        {% if activity.type == 'lesson_completion' %}bg-emerald-500/20 border border-emerald-500/30 text-emerald-400
                        {% elif activity.type == 'quiz_attempt' %}bg-cyan-500/20 border border-cyan-500/30 text-cyan-400
                        {% elif activity.type == 'certification' %}bg-amber-500/20 border border-amber-500/30 text-amber-400
                        {% else %}text-slate-300{% endif %}" style="{% if activity.type != 'lesson_completion' and activity.type != 'quiz_attempt' and activity.type != 'certification' %}background-color: rgba(24, 29, 55, 0.6); border: 1px solid rgba(99, 102, 241, 0.3);{% endif %}">
                        {% if activity.type == 'lesson_completion' %}
                        <i class="fas fa-check-circle"></i>
                        {% elif activity.type == 'quiz_attempt' %}
                        <i class="fas fa-question-circle"></i>
                        {% elif activity.type == 'certification' %}
                        <i class="fas fa-trophy"></i>
                        {% else %}
                        <i class="fas fa-circle"></i>
                        {% endif %}
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="font-semibold text-white text-sm mb-1">{{ activity.content }}</div>
                        <div class="text-xs text-slate-400">{{ activity.user.get_full_name|default:activity.user.username }}</div>
                    </div>
                    <div class="text-xs font-medium text-slate-400 whitespace-nowrap">{{ activity.timestamp|timesince }} ago</div>
                    <a href="{{ activity.url }}" class="px-3 py-1.5 bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-lg text-xs font-semibold hover:shadow-lg hover:shadow-cyan-500/20 transition-all focus:outline-none focus:ring-2 focus:ring-cyan-500 whitespace-nowrap">
                        View
                    </a>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-12">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-xl mb-4" style="background-color: rgba(99, 102, 241, 0.2);">
                    <i class="fas fa-inbox text-2xl text-slate-400"></i>
                </div>
                <p class="text-sm font-medium text-slate-300">No recent activity</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
